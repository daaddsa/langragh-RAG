# 2-1. 需求规格说明书 (精简版)

## 1. 引言

### 1.1 编写目的
本文档描述“智搜研报助手（精简版）”的核心功能需求，作为2周敏捷开发的指导文件。

### 1.2 范围
本项目仅实现一个单用户、基于Web的智能搜索与PDF导出工具，不涉及多租户管理和复杂后台。

## 2. 功能需求 (Functional Requirements)

### 2.1 智能对话 (FR-01)
*   **描述**：用户输入自然语言问题，系统进行回复。
*   **优先级**：P0 (最高)
*   **输入**：文本。
*   **输出**：文本回复。
*   **约束**：支持流式输出 (Streaming)，提升用户体验。

### 2.2 联网搜索 (FR-02)
*   **描述**：当用户问题涉及实时信息（如“今天的天气”、“最新的AI论文”）时，Agent自动调用搜索引擎。
*   **优先级**：P0
*   **逻辑**：
    1.  LLM判断是否需要搜索。
    2.  若需要，生成搜索关键词。
    3.  调用Tavily API获取Top-3结果。
    4.  基于搜索结果生成回答，并标注来源。

### 2.3 上下文记忆 (FR-03)
*   **描述**：支持至少5轮的连续对话。
*   **优先级**：P1
*   **实现**：使用LangGraph的 `MemorySaver` 或 SQLite 存储 `messages` 列表。

### 2.4 PDF导出 (FR-04)
*   **描述**：将当前会话记录导出为PDF文件。
*   **优先级**：P1
*   **内容**：包含用户问题、AI回答及参考链接。
*   **格式**：A4纸张，支持中文显示，无乱码。

### 2.5 参数配置 (FR-05)
*   **描述**：允许用户在侧边栏配置API Key（OpenAI/Tavily）。
*   **优先级**：P2
*   **目的**：方便不同用户使用自己的Key，降低部署成本。

## 3. 非功能需求 (Non-Functional Requirements)

### 3.1 易用性
*   界面简洁直观，使用 Streamlit 标准组件。
*   无需安装复杂环境，提供 `requirements.txt` 一键安装。

### 3.2 响应速度
*   普通对话响应 < 3秒。
*   搜索对话响应 < 15秒（受限于网络和API延迟）。

### 3.3 可靠性
*   搜索失败时（如API额度耗尽），应提示用户并尝试仅用LLM自身知识回答。

## 4. 假设与依赖
*   用户需自备 OpenAI API Key 和 Tavily API Key。
*   开发机具备访问外网（特别是OpenAI API）的能力。
