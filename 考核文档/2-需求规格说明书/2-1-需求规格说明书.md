# 2-1. 需求规格说明书 (精简版)

## 1. 引言

### 1.1 编写目的
本文档描述“智搜研报助手（精简版）”的核心功能需求，作为2周敏捷开发的指导文件。

### 1.2 范围
本项目实现一个单用户、基于Web的智能搜索与PDF导出工具，旨在为用户提供基于实时联网信息的智能问答服务，并支持将对话内容整理导出。

## 2. 功能需求 (Functional Requirements)

### 2.1 智能对话 (FR-01)
*   **描述**：用户输入自然语言问题，系统进行回复。
*   **优先级**：P0 (最高)
*   **输入**：文本。
*   **输出**：文本回复。
*   **约束**：支持流式输出 (Streaming)，即打字机效果，提升用户体验。

### 2.2 联网搜索 (FR-02)
*   **描述**：当用户问题涉及实时信息（如“今天的天气”、“最新的AI论文”）时，Agent自动调用搜索引擎。
*   **优先级**：P0
*   **逻辑**：
    1.  LLM判断是否需要搜索。
    2.  若需要，生成搜索关键词。
    3.  调用 Tavily API 获取搜索结果（Top-5）。
    4.  基于搜索结果生成回答，并标注来源。

### 2.3 上下文记忆 (FR-03)
*   **描述**：支持多轮连续对话，系统能理解上下文。
*   **优先级**：P1
*   **实现**：使用 LangGraph 的 `MemorySaver`（内存存储）。
*   **注意**：由于采用内存存储，服务重启后会话历史会重置（符合Lite版设计）。

### 2.4 PDF导出 (FR-04)
*   **描述**：将当前会话记录导出为PDF文件。
*   **优先级**：P1
*   **内容**：包含用户问题、AI回答及生成时间。
*   **格式**：A4纸张，**支持中文显示**（使用 Simsun.ttc 字体），自动排版。

### 2.5 多模型支持与参数配置 (FR-05)
*   **描述**：允许用户在侧边栏配置不同厂商的模型及 API Key。
*   **优先级**：P2
*   **支持厂商**：
    *   OpenAI (GPT-3.5/4)
    *   DeepSeek
    *   Moonshot (Kimi)
    *   Aliyun (Qwen)
*   **目的**：灵活适应不同用户的 API 资源，并解决单一模型可能的访问受限问题。

## 3. 非功能需求 (Non-Functional Requirements)

### 3.1 易用性
*   界面简洁直观，使用 Streamlit 标准组件。
*   侧边栏提供清晰的设置入口。
*   提供“清空对话”功能，方便开启新话题。

### 3.2 响应速度
*   普通对话响应 < 3秒（首字生成）。
*   搜索对话响应 < 15秒（取决于网络和搜索API延迟）。

### 3.3 可靠性
*   搜索失败时（如API额度耗尽），应提示用户并尝试仅用LLM自身知识回答。
*   PDF生成具备容错机制，若后端状态丢失，支持由前端传入历史数据进行生成。

## 4. 假设与依赖
*   用户需自备相应模型厂商的 API Key 和 Tavily API Key。
*   运行环境需安装 Python 3.10+ 及 `requirements.txt` 中的依赖。
*   PDF 生成依赖 `backend/assets/simsun.ttc` 字体文件。
